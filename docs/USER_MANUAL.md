# ProvChain-Org User Manual

**üìò NEW: Comprehensive User Manual Available!**

> **For complete, user-friendly documentation**, see the **[ProvChain User Manual](user-manual/)** - a comprehensive guide covering:
> - üöÄ 10-Minute Quick Start
> - üìù Submitting Transactions (with examples)
> - üîç Query Library (30+ ready-to-use SPARQL queries)
> - ‚öôÔ∏è Configuration & Network Setup
> - üÜò Troubleshooting Guide
> 
> **[Go to User Manual ‚Üí](user-manual/)**

---

## Quick Reference (Legacy)

This page provides a quick reference for common operations. For detailed documentation, see the **[User Manual](user-manual/)**.

## Table of Contents

1.  [Getting Started](#getting-started)
2.  [Running the System](#running-the-system)
3.  [Generating an API Key](#generating-an-api-key)
4.  [Submitting Transactions](#submitting-transactions)
5.  [Querying Data](#querying-data)
6.  [Validating the Blockchain](#validating-the-blockchain)
7.  [Troubleshooting](#troubleshooting)

---

## 1. Getting Started

### Prerequisites

*   **Docker** and **Docker Compose** installed on your machine.
*   Basic familiarity with the command line.

---

## 2. Running the System

We provide a Docker-based deployment that sets up a fully functional 3-node blockchain network.

### Step 1: Deploy the Nodes

1.  Navigate to the `deploy/` directory:
    ```bash
    cd deploy
    ```

2.  Start the network using Docker Compose:
    ```bash
    docker-compose -f docker-compose.3node.yml up -d --build
    ```

    This will start:
    *   **Node 1**: `http://localhost:8080`
    *   **Node 2**: `http://localhost:8081`
    *   **Node 3**: `http://localhost:8082`
    *   **Monitoring Stack**: Prometheus, Grafana, Jaeger.

3.  Verify the nodes are running:
    ```bash
    docker ps
    ```
    You should see `provchain-node1`, `provchain-node2`, `provchain-node3` in the list.

4.  Check the status of Node 1:
    ```bash
    curl http://localhost:8080/api/status
    ```

---

## 3. Generating an API Key

To interact with the system (submit data or query), you need an API Key (JWT Token).

Since you are running via Docker, execute the following command to generate a key from **Node 1**:

```bash
    docker exec -it provchain-node1 provchain-org generate-api-key
```

*Save the output string. This is your `YOUR_API_KEY`.*

---

## 4. Submitting Transactions

In ProvChainOrg, a "transaction" is the submission of RDF data (Turtle format) describing a supply chain event.

### Endpoint
*   **URL**: `http://localhost:8080/api/data`
*   **Method**: `POST`
*   **Content-Type**: `text/turtle`

### Example: Creating a Product Batch

Save the following content to a file named `batch_data.ttl`:

```turtle
@prefix : <http://example.org/supply-chain#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

:Batch001 a :ProductBatch ;
    :hasBatchID "BATCH-001" ;
    :product :OrganicTomatoes ;
    :harvestDate "2025-01-14"^^xsd:date ;
    :originFarm :GreenValleyFarm .
```

Submit it using `curl`:

```bash
curl -X POST http://localhost:8080/api/data \
  -H "Content-Type: text/turtle" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d @batch_data.ttl
```

**Success Response:**
```json
{
  "success": true,
  "data": {
    "block_index": 1,
    "block_hash": "0x...",
    "timestamp": "..."
  }
}
```

---

## 5. Querying Data

You can query the blockchain using SPARQL.

### Endpoint
*   **URL**: `http://localhost:8080/api/query`
*   **Method**: `POST`
*   **Content-Type**: `application/sparql-query`

### Example: Finding All Products

Submit the following SPARQL query:

```bash
curl -X POST http://localhost:8080/api/query \
  -H "Content-Type: application/sparql-query" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '
    PREFIX : <http://example.org/supply-chain#>
    SELECT ?batch ?product ?farm WHERE {
        ?batch a :ProductBatch ;
               :product ?product ;
               :originFarm ?farm .
    }
  '
```

**Response:**
```json
{
  "success": true,
  "data": {
    "results": [
      {
        "batch": "http://example.org/supply-chain#Batch001",
        "product": "http://example.org/supply-chain#OrganicTomatoes",
        "farm": "http://example.org/supply-chain#GreenValleyFarm"
      }
    ]
  }
}
```

---

## 6. Validating the Blockchain

To ensure data integrity and verify that all nodes are in sync.

### Endpoint
*   **URL**: `http://localhost:8080/api/validate`
*   **Method**: `POST`

### Command

```bash
curl -X POST http://localhost:8080/api/validate \
  -H "Authorization: Bearer YOUR_API_KEY"
```

**Response:**
```json
{
  "success": true,
  "data": {
    "is_valid": true,
    "total_blocks": 2
  }
}
```

---

## 7. Troubleshooting

### Connection Refused
*   Ensure Docker containers are running: `docker ps`.
*   Check if ports 8080, 8081, 8082 are occupied by other services.

### Authentication Failed
*   Ensure you are using the exact token generated by the `generate-api-key` command.
*   Ensure you included the `Bearer ` prefix in the Authorization header.

### Invalid RDF Data
*   The system validates RDF syntax. Ensure your Turtle (`.ttl`) format is correct.
*   Check prefixes (`@prefix`) are correctly defined.

### System Logs
To view logs for a specific node (e.g., Node 1):
```bash
docker logs -f provchain-node1
```

---

## üìö Complete Documentation

For comprehensive guides, tutorials, and reference material, see the **[ProvChain User Manual](user-manual/)**.

### User Manual Sections

| Section | Description | Link |
|---------|-------------|------|
| **Quick Start** | Get running in 10 minutes | [10-Minute Setup](user-manual/00-quick-start/10-minute-setup.md) |
| **Overview** | What is ProvChain? | [Overview](user-manual/00-quick-start/overview.md) |
| **First Transaction** | Submit your first data | [First Transaction](user-manual/00-quick-start/first-transaction.md) |
| **Query Library** | 30+ SPARQL queries | [Query Library](user-manual/03-querying-data/query-library.md) |
| **Network Setup** | Configure peers | [Network Setup](user-manual/05-configuration/network-setup.md) |
| **Troubleshooting** | Solve problems | [Troubleshooting](user-manual/08-troubleshooting/troubleshooting.md) |

---

### Quick Links by Task

**I want to...**
- üöÄ Get started quickly: [10-Minute Quick Start](user-manual/00-quick-start/10-minute-setup.md)
- üìù Submit product data: [Submitting Product Batches](user-manual/02-submitting-data/product-batches.md)
- üîç Query blockchain data: [Query Library](user-manual/03-querying-data/query-library.md)
- ‚öôÔ∏è Configure network peers: [Network Setup](user-manual/05-configuration/network-setup.md)
- üÜò Fix a problem: [Troubleshooting](user-manual/08-troubleshooting/troubleshooting.md)

---

### Developer Documentation

For API reference, architecture, and developer guides:
- [API Documentation](api/)
- [Architecture Guide](ARCHITECTURE.md)
- [Deployment Guide](deployment/)

---

**üìñ Back to [User Manual](user-manual/)** | **üè† Back to [Main README](../README.md)**

